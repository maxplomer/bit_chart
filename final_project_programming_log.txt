This is a guide and note for the creation of my final project with the working name "Finance Clone" and tag line "Facebook meets google finance".


//// Topic: Initial Rails Installation ////

$ rails _4.0.2_ new finance_clone --database postgresql


config/database.yml by adding username: maxplomer and host: localhost

When using postgresql, you should also run the command

$ rake db:create:all

add .DS_Store and .localized to .gitignore

in the terminal before trying to run migrations

# Add to Gemfile
group :development do
  gem 'better_errors'
  gem 'binding_of_caller'
  gem 'pry-rails'
  gem 'quiet_assets'
end






//// Topic: stock_quote ruby gem ////

https://github.com/tyrauber/stock_quote


Include the gem in your Gemfile:

gem "stock_quote"


sample usage:


$ gem install stock_quote
$ irb
> require 'stock_quote'
> stock = StockQuote::Stock.quote("tsla")
> stock.ask_realtime
 => 222.65 







//// price model ////


$ rails generate model Quote

attributes: price and company_id

migration file:

class CreateQuotes < ActiveRecord::Migration
  def change
    create_table :quotes do |t|
      t.integer :company_id, :null => false
      t.float :price, :null => false 

      t.timestamps
    end
  end
end


//// company model ////

$ rails generate model Company

attributes: name and symbol

migration file:

class CreateCompanies < ActiveRecord::Migration
  def change
    create_table :companies do |t|
      t.string :name, :null => false
      t.string :symbol, :null => false
      t.timestamps
    end
  end
end







//// seeds.rb ////

added

Company.create(name: "Apple Inc.", symbol: "AAPL")
Quote.create(company_id: 1, price: 105.23)




//// run migrate and seed /////

$ rake db:migrate db:seed

go into console and make sure company and price is there


$ commit -m "initial rails setup"



//// Topic: need to have a script that runs every minute in background ////

store stock quote price monday-friday 9:30am to 4pm

i tried google search for: script that runs every minute rails

intermediate step will be calling stock_quote in seeds.rb file to set price



From:

http://stackoverflow.com/questions/285717/a-cron-job-for-rails-best-practices

I found:

https://github.com/javan/whenever

which is a ruby gem for writing and deploying cron jobs

cron is a time-based job scheduler







it seems like what i need to do is run this scheduler at system startup

http://stackoverflow.com/questions/3790867/ruby-on-rails-run-a-method-on-server-start-2-3

can put method call at bottom of boot.rb? NO



$ cd /desktop/finance_clone
$ wheneverize .


add to config/schedule.rb

every 1.second do
  symbol = "FSLR"

  company = Company.find_by_symbol(symbol)
  company_id = company.id

  stock = StockQuote::Stock.quote("tsla")
  price = stock.ask_realtime
   
  Quote.create(company_id: company_id, price: price)
end



Or with Bundler in your Gemfile.

gem 'whenever', :require => false



In your "config/boot.rb" file:

require "whenever/capistrano"  NO triggers error



maybe i need to write require 'whenever'  first?
